{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"reflect-metadata\"","webpack:///external \"typedi\"","webpack:///./server/services/system/index.ts","webpack:///./server/services/index.ts","webpack:///./server/services/system/Storage.service.ts","webpack:///external \"events\"","webpack:///external \"routing-controllers\"","webpack:///external \"socket-controllers\"","webpack:///external \"db-migrate-shared\"","webpack:///./main.ts","webpack:///./server/index.ts","webpack:///./server/polyfills.ts","webpack:///external \"http\"","webpack:///external \"express\"","webpack:///external \"socket.io\"","webpack:///external \"morgan\"","webpack:///external \"figlet\"","webpack:///external \"cors\"","webpack:///external \"path\"","webpack:///./server/controllers/index.ts","webpack:///./server/controllers/rest/RootController.ts","webpack:///./server/services/system/Logger.service.ts","webpack:///external \"winston\"","webpack:///./server/services/system/Setting.service.ts","webpack:///./server/services/system/SocketManager.service.ts","webpack:///external \"db-migrate-sqlite3\"","webpack:///./server/controllers/websocket/WsMessageController.ts","webpack:///./server/services/system/StorageMigration.service.ts","webpack:///./server/services/system/repositories/Migration_log.repository.ts","webpack:///external \"ejs\""],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","require","__importDefault","this","mod","default","Logger_service_1","LoggerSrv","Setting_service_1","SettingSrv","SocketManager_service_1","SocketManagerSrv","Storage_service_1","StorageSrv","system_1","__decorate","decorators","target","desc","arguments","length","getOwnPropertyDescriptor","Reflect","decorate","__metadata","k","v","metadata","driver","dataType","typedi_1","_1","events_1","EventEmitter","[object Object]","logger","settingSrv","super","info","dbname","getSystemDbName","Promise","resolve","reject","connect","then","db","error","sqlLogger","internals","log","type","interfaces","SeederInterface","MigratorInterfrace","filename","err","all","Service","process","env","PORT","runServ","__dirname","__awaiter","thisArg","_arguments","P","generator","fulfilled","step","next","e","rejected","result","done","apply","routing_controllers_1","socket_controllers_1","http_1","express_1","socket_io_1","morgan","figlet","cors","path","services_1","StorageMigration_service_1","port","rootPath","join","useContainer","Container","app","use","engine","renderFile","set","useExpressServer","server","createServer","static","io","socket","console","useSocketServer","controllers","loggerSrv","textSync","stream","addServices","parseInt","getPort","middleware","etcInstances","instance","registerServices","service","init","stack","emit","once","listen","RootController","hello","Get","Render","Function","Controller","winston_1","createLogger","format","combine","timestamp","level","assign","message","printf","meta","line","transports","Console","handleExceptions","File","exitOnError","encoding","msg","index","alert","crit","data","debug","help","input","notice","prompt","silly","verbose","warn","warning","settings","loadSettingFile","len","Math","random","toString","substr","sqlite","sockets","id","event","__param","paramIndex","decorator","WsMessageController","sockMgrSrv","addSocket","delSocket","OnConnect","ConnectedSocket","OnDisconnect","SocketController","Migration_log_repository_1","StorageMigrationSrv","storageSrv","migrationLogRepository","migrations","migrationLogs","getMigrationLog","logs","success","migration_id","addMigrations","dbMigration","action","args","push","arr","migration","concat","callback","params","replace","arg","JSON","stringify","slice","__1","Migration_logRepository","tableName","INTEGER","primaryKey","autoIncrement","notNull","STRING","TEXT","defaultValue","BOOLEAN","DATE_TIME","String"],"mappings":"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","file":"server.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 9);\n","module.exports = require(\"reflect-metadata\");","module.exports = require(\"typedi\");","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst Logger_service_1 = __importDefault(require(\"./Logger.service\"));\nexports.LoggerSrv = Logger_service_1.default;\nconst Setting_service_1 = __importDefault(require(\"./Setting.service\"));\nexports.SettingSrv = Setting_service_1.default;\nconst SocketManager_service_1 = __importDefault(require(\"./SocketManager.service\"));\nexports.SocketManagerSrv = SocketManager_service_1.default;\nconst Storage_service_1 = __importDefault(require(\"./Storage.service\"));\nexports.StorageSrv = Storage_service_1.default;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nrequire(\"reflect-metadata\");\n// System Services\nconst system_1 = require(\"./system\");\nexports.SettingSrv = system_1.SettingSrv;\nexports.StorageSrv = system_1.StorageSrv;\nexports.LoggerSrv = system_1.LoggerSrv;\nexports.SocketManagerSrv = system_1.SocketManagerSrv;\n","\"use strict\";\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/*\n    sqlite3 node libraries\n    ref: https://db-migrate.readthedocs.io/en/latest/API/SQL/#migrations-api-sql\n*/\nconst driver = require(\"db-migrate-sqlite3\");\nconst { dataType } = require('db-migrate-shared');\nrequire(\"reflect-metadata\");\nconst typedi_1 = require(\"typedi\");\nconst _1 = require(\".\");\nconst events_1 = require(\"events\");\nlet StorageSrv = class StorageSrv extends events_1.EventEmitter {\n    constructor(logger, settingSrv) {\n        super();\n        this.logger = logger;\n        this.settingSrv = settingSrv;\n        this.logger.info(\"created StorageSrv\");\n        this.dbname = this.settingSrv.getSystemDbName();\n    }\n    init() {\n        return new Promise((resolve, reject) => {\n            this.connect(this.dbname).then((db) => {\n                this.db = db;\n                this.logger.info(`Connected to the ${this.dbname} database.`);\n                resolve();\n            }, (error) => {\n                reject(error);\n            });\n        });\n    }\n    connect(dbname) {\n        this.logger.info(`try load sqlite : ${dbname}`);\n        this.logger['sql'] = this.sqlLogger.bind(this);\n        return new Promise((resolve, reject) => {\n            /* if not exist then create database file */\n            const internals = {\n                mod: {\n                    log: this.logger,\n                    type: dataType,\n                },\n                interfaces: {\n                    SeederInterface: {},\n                    MigratorInterfrace: {},\n                }\n            };\n            driver.connect({ driver: \"sqlite3\", filename: this.dbname }, internals, (err, db) => {\n                if (err) {\n                    reject(err);\n                }\n                else {\n                    db.all(\"PRAGMA foreign_keys=ON\");\n                    resolve(db);\n                }\n            });\n        });\n    }\n    sqlLogger() {\n        // this.logger.debug(arguments[0], { meta: { __filename, __function: (global as any).__function, __line: (global as any).__line } } );\n    }\n};\nStorageSrv = __decorate([\n    typedi_1.Service(),\n    __metadata(\"design:paramtypes\", [_1.LoggerSrv,\n        _1.SettingSrv])\n], StorageSrv);\nexports.default = StorageSrv;\n","module.exports = require(\"events\");","module.exports = require(\"routing-controllers\");","module.exports = require(\"socket-controllers\");","module.exports = require(\"db-migrate-shared\");","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst server_1 = __importDefault(require(\"./server\"));\nconst serv = new server_1.default(process.env.PORT);\nserv.runServ();\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nrequire(\"reflect-metadata\");\nrequire(\"./polyfills\");\nconst routing_controllers_1 = require(\"routing-controllers\");\nconst socket_controllers_1 = require(\"socket-controllers\");\nconst typedi_1 = require(\"typedi\");\nconst http_1 = __importDefault(require(\"http\"));\nconst express_1 = __importDefault(require(\"express\"));\nconst socket_io_1 = __importDefault(require(\"socket.io\"));\nconst morgan = require('morgan');\nconst figlet = require('figlet');\nconst cors = require(\"cors\");\nconst path = require('path');\nrequire(\"./controllers\");\nconst services_1 = require(\"./services\");\nconst StorageMigration_service_1 = __importDefault(require(\"./services/system/StorageMigration.service\"));\nconst events_1 = require(\"events\");\nclass MainServer extends events_1.EventEmitter {\n    constructor(port) {\n        const rootPath = path.join(\"dist\");\n        super();\n        /* setter */\n        routing_controllers_1.useContainer(typedi_1.Container);\n        socket_controllers_1.useContainer(typedi_1.Container);\n        /* create Server */\n        this.app = express_1.default();\n        this.app.use(cors());\n        /* set Html View Render */\n        this.app.engine('html', require('ejs').renderFile);\n        this.app.set('views', path.join(rootPath, 'public'));\n        this.app.set('view engine', 'html');\n        routing_controllers_1.useExpressServer(this.app);\n        this.server = http_1.default.createServer(this.app);\n        this.app.use(\"/public\", express_1.default.static(rootPath));\n        /* create websocket listener */\n        this.io = socket_io_1.default(this.server);\n        this.io.use((socket, next) => {\n            console.log(\"Custom middleware\");\n            next();\n        });\n        console.log(__dirname);\n        socket_controllers_1.useSocketServer(this.io, {\n            controllers: [path.join(__dirname, \"controllers\", \"websocket\", \"*.js\")],\n        });\n        /* create System Logger */\n        const loggerSrv = typedi_1.Container.get(services_1.LoggerSrv);\n        loggerSrv.info(`\\n${figlet.textSync(\"Sample\")}`);\n        /* register logger Service */\n        this.app.use(morgan('combined', { stream: loggerSrv }));\n        /* register service instance */\n        this.addServices();\n        this.port = port ? parseInt(port) : typedi_1.Container.get(services_1.SettingSrv).getPort();\n    }\n    addMiddleware(middleware) {\n        this.app.use(middleware);\n    }\n    addServices() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const etcInstances = [\n                { name: \"socketIO\", instance: this.io },\n            ];\n            const loggerSrv = typedi_1.Container.get(services_1.LoggerSrv);\n            for (const { name, instance } of etcInstances) {\n                typedi_1.Container.set(name, instance);\n                loggerSrv.info(`[init] DI Registered ${name}`);\n            }\n            const registerServices = [\n                /* System Services */\n                services_1.SettingSrv,\n                services_1.StorageSrv,\n                StorageMigration_service_1.default,\n                services_1.SocketManagerSrv,\n            ];\n            // register system services\n            for (const service of registerServices) {\n                try {\n                    const instance = typedi_1.Container.get(service);\n                    yield instance.init();\n                    loggerSrv.info(`[Serivce Initialize] DI Registered ${service.name}`);\n                }\n                catch (e) {\n                    console.log(e.stack);\n                    loggerSrv.error(e);\n                }\n            }\n            this.emit(\"ready\");\n        });\n    }\n    getApp() {\n        return this.app;\n    }\n    runServ() {\n        const loggerSrv = typedi_1.Container.get(services_1.LoggerSrv);\n        return new Promise((resolve) => {\n            this.once(\"ready\", () => {\n                resolve(this.server.listen(this.port, () => loggerSrv.info(`listening on port ${this.port}`)));\n            });\n        });\n    }\n}\nexports.default = MainServer;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/** reflect-metadata **/\nrequire(\"reflect-metadata\");\n// /** fetch **/\n// import 'isomorphic-fetch';\n/** Symbol.asyncIterator **/\n// import 'core-js/es7/symbol'\n","module.exports = require(\"http\");","module.exports = require(\"express\");","module.exports = require(\"socket.io\");","module.exports = require(\"morgan\");","module.exports = require(\"figlet\");","module.exports = require(\"cors\");","module.exports = require(\"path\");","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nrequire(\"./rest/RootController\");\nrequire(\"./websocket/WsMessageController\");\n","\"use strict\";\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nrequire(\"reflect-metadata\");\nconst routing_controllers_1 = require(\"routing-controllers\");\nconst services_1 = require(\"../../services\");\nlet RootController = class RootController {\n    constructor(loggerSrv) {\n        this.loggerSrv = loggerSrv;\n        this.loggerSrv.info(\"created RootController\");\n    }\n    helloServer() {\n    }\n    getApi() {\n        return [\n            { hello: \"Hello Node.js Express Server\" },\n        ];\n    }\n};\n__decorate([\n    routing_controllers_1.Get(\"/\"),\n    routing_controllers_1.Render(\"index.html\"),\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", []),\n    __metadata(\"design:returntype\", void 0)\n], RootController.prototype, \"helloServer\", null);\n__decorate([\n    routing_controllers_1.Get(\"/api\"),\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", []),\n    __metadata(\"design:returntype\", void 0)\n], RootController.prototype, \"getApi\", null);\nRootController = __decorate([\n    routing_controllers_1.Controller(\"\"),\n    __metadata(\"design:paramtypes\", [services_1.LoggerSrv])\n], RootController);\nexports.RootController = RootController;\n","\"use strict\";\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nrequire(\"reflect-metadata\");\nconst winston_1 = require(\"winston\");\nconst typedi_1 = require(\"typedi\");\nlet LoggerSrv = class LoggerSrv {\n    constructor() {\n        this.logger = winston_1.createLogger({\n            // level: 'info',\n            format: winston_1.format.combine(winston_1.format.timestamp({ format: `YYYY-MM-DD HH:mm:ss` }), winston_1.format(info => {\n                if (info.level === \"error\") {\n                    return Object.assign({}, info, {\n                        message: `${info.timestamp} ${info.stack}`,\n                    });\n                }\n                return info;\n            })(), winston_1.format.printf(info => (info.meta)\n                ? `${info.timestamp} ${info.level} [${info.meta.filename}:${info.meta.line}]: ${info.message}`\n                : `${info.timestamp} ${info.level} ${info.message}`)),\n            transports: [\n                new winston_1.transports.Console({ level: 'debug', handleExceptions: true, }),\n                new winston_1.transports.File({ filename: 'error.log', level: 'error' }),\n                new winston_1.transports.File({ filename: 'system.log' })\n            ],\n            exitOnError: false\n        });\n    }\n    init() {\n        this.logger.info(\"created LoggerSrv\");\n    }\n    write(message, encoding) { this.logger.info(message); }\n    alert(msg, index = 3) { this.logger.alert(msg); }\n    crit(msg, index = 3) { this.logger.crit(msg); }\n    data(msg, index = 3) { this.logger.data(msg); }\n    debug(msg, index = 3) { this.logger.debug(msg); }\n    error(msg, index = 3) { this.logger.error(msg); }\n    help(msg, index = 3) { this.logger.help(msg); }\n    input(msg, index = 3) { this.logger.input(msg); }\n    info(msg, index = 3) { this.logger.info(msg); }\n    log(level, msg, index = 3) { this.logger.log(level, msg); }\n    notice(msg, index = 3) { this.logger.notice(msg); }\n    sql(msg, index = 3) { this.debug(msg, index); }\n    prompt(msg, index = 3) { this.logger.prompt(msg); }\n    silly(msg, index = 3) { this.logger.silly(msg); }\n    verbose(msg, index = 3) { this.logger.verbose(msg); }\n    warn(msg, index = 3) { this.logger.warn(msg); }\n    warning(msg, index = 3) { this.logger.warning(msg); }\n};\nLoggerSrv = __decorate([\n    typedi_1.Service(),\n    __metadata(\"design:paramtypes\", [])\n], LoggerSrv);\nexports.default = LoggerSrv;\n","module.exports = require(\"winston\");","\"use strict\";\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nrequire(\"reflect-metadata\");\nconst typedi_1 = require(\"typedi\");\nconst _1 = require(\".\");\nlet SettingSrv = class SettingSrv {\n    constructor(logger) {\n        this.logger = logger;\n        this.logger.info(\"created SettingSrv\");\n        this.settings = this.loadSettingFile();\n    }\n    init() {\n        return Promise.resolve();\n    }\n    /**\n     * Create a `uid`\n     *\n     * @param { Number } len\n     * @return { String } uid\n     */\n    uid(len) {\n        // create uuid\n        len = len || 7;\n        return Math.random().toString(35).substr(2, len);\n    }\n    loadSettingFile() {\n        const config = require(\"../../config/config.json\");\n        return config;\n    }\n    getPort() {\n        return this.settings[\"port\"];\n    }\n    getSystemDbName() {\n        return this.settings.sqlite;\n    }\n    getSettings() {\n        return this.settings;\n    }\n};\nSettingSrv = __decorate([\n    typedi_1.Service(),\n    __metadata(\"design:paramtypes\", [_1.LoggerSrv])\n], SettingSrv);\nexports.default = SettingSrv;\n","\"use strict\";\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nrequire(\"reflect-metadata\");\nconst typedi_1 = require(\"typedi\");\nconst _1 = require(\".\");\nlet SocketManagerSrv = class SocketManagerSrv {\n    constructor(logger) {\n        this.logger = logger;\n        this.sockets = {};\n        this.logger.info(\"created SocketMangerSrv\");\n    }\n    init() {\n        return Promise.resolve();\n    }\n    addSocket(socket) {\n        const { id } = socket;\n        this.sockets[id] = socket;\n        this.logger.info(`registerd ${id}`);\n    }\n    delSocket(id) {\n        this.logger.info(`unregisterd ${id}`);\n        delete this.sockets[id];\n    }\n    getSocket(id) {\n        return this.sockets[id];\n    }\n    isExistSocket(id) {\n        return !!this.sockets[id];\n    }\n    getAll() {\n        return this.sockets;\n    }\n    emitAll(event, message) {\n        for (const id in this.sockets) {\n            const socket = this.sockets[id];\n            socket.emit(event, message);\n        }\n    }\n};\nSocketManagerSrv = __decorate([\n    typedi_1.Service(),\n    __metadata(\"design:paramtypes\", [_1.LoggerSrv])\n], SocketManagerSrv);\nexports.default = SocketManagerSrv;\n","module.exports = require(\"db-migrate-sqlite3\");","\"use strict\";\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst socket_controllers_1 = require(\"socket-controllers\");\nconst services_1 = require(\"../../services\");\nlet WsMessageController = class WsMessageController {\n    constructor(sockMgrSrv, loggerSrv) {\n        this.sockMgrSrv = sockMgrSrv;\n        this.loggerSrv = loggerSrv;\n        this.loggerSrv.info(\"created WsMessageController\");\n    }\n    connection(socket) {\n        this.sockMgrSrv.addSocket(socket);\n        this.loggerSrv.info(\"client connected\");\n    }\n    disconnect(socket) {\n        const { id } = socket;\n        this.sockMgrSrv.delSocket(id);\n    }\n};\n__decorate([\n    socket_controllers_1.OnConnect(),\n    __param(0, socket_controllers_1.ConnectedSocket()),\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", [Object]),\n    __metadata(\"design:returntype\", void 0)\n], WsMessageController.prototype, \"connection\", null);\n__decorate([\n    socket_controllers_1.OnDisconnect(),\n    __param(0, socket_controllers_1.ConnectedSocket()),\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", [Object]),\n    __metadata(\"design:returntype\", void 0)\n], WsMessageController.prototype, \"disconnect\", null);\nWsMessageController = __decorate([\n    socket_controllers_1.SocketController(\"/ws\"),\n    __metadata(\"design:paramtypes\", [services_1.SocketManagerSrv,\n        services_1.LoggerSrv])\n], WsMessageController);\nexports.WsMessageController = WsMessageController;\n","\"use strict\";\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nrequire(\"reflect-metadata\");\nconst typedi_1 = require(\"typedi\");\nconst events_1 = require(\"events\");\nconst Migration_log_repository_1 = __importDefault(require(\"./repositories/Migration_log.repository\"));\nconst Storage_service_1 = __importDefault(require(\"./Storage.service\"));\nconst _1 = require(\".\");\nlet StorageMigrationSrv = class StorageMigrationSrv extends events_1.EventEmitter {\n    constructor(logger, storageSrv, \n    /* sqlite3 table reposiotries */\n    migrationLogRepository) {\n        super();\n        this.logger = logger;\n        this.storageSrv = storageSrv;\n        this.migrationLogRepository = migrationLogRepository;\n        this.migrations = [];\n        this.logger.info(\"created StorageMigrationSrv\");\n    }\n    init() {\n        let migrationLogs = {};\n        return this.migrationLogRepository.getMigrationLog().then((logs) => {\n            for (const log of logs) {\n                if (log.success) {\n                    migrationLogs[log.migration_id] = log;\n                }\n            }\n            return migrationLogs;\n        }).then((migrationLogs) => {\n            this.addMigrations();\n            this.dbMigration(migrationLogs);\n        });\n    }\n    addMigration(migration_id, action, args) {\n        this.migrations.push({ migration_id, action, args });\n    }\n    addMigrations() {\n        const arr = [\n            this.migrationLogRepository.migrations(),\n        ];\n        for (const migration of arr) {\n            this.migrations = this.migrations.concat(migration);\n        }\n    }\n    dbMigration(migrationLogs) {\n        for (const { migration_id, action, args } of this.migrations) {\n            if (!migrationLogs[migration_id]) {\n                this.logger.info(`execute ${migration_id}`);\n                /* change callback function */\n                const callback = args[args.length - 1];\n                args[args.length - 1] = (...params) => {\n                    const [err] = params;\n                    const success = !err ? true : false;\n                    /* double quatation이 들어간 경우 오류 발생 */\n                    const error = err ? err.message.replace(/\\\"/gi, \"'\") : \"\";\n                    const arg = JSON.stringify(args.slice(0, args.length - 1)).replace(/\\\"/gi, \"'\");\n                    /* write migration_log */\n                    this.storageSrv.db[\"insert\"](\"migration_log\", [\"migration_id\", \"action\", \"success\", \"error\", \"params\",], [migration_id, action, success, error, arg], (err) => {\n                        if (err) {\n                            this.logger.error(err);\n                        }\n                    });\n                    callback.apply(this.storageSrv.db, params);\n                };\n                try {\n                    this.storageSrv.db[action].apply(this.storageSrv.db, args);\n                }\n                catch (err) {\n                    this.logger.error(err);\n                }\n            }\n        }\n    }\n};\nStorageMigrationSrv = __decorate([\n    typedi_1.Service(),\n    __metadata(\"design:paramtypes\", [_1.LoggerSrv,\n        Storage_service_1.default,\n        Migration_log_repository_1.default])\n], StorageMigrationSrv);\nexports.default = StorageMigrationSrv;\n","\"use strict\";\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nrequire(\"reflect-metadata\");\nconst typedi_1 = require(\"typedi\");\nconst Storage_service_1 = __importDefault(require(\"../Storage.service\"));\nconst __1 = require(\"..\");\nconst { dataType } = require('db-migrate-shared');\nlet Migration_logRepository = class Migration_logRepository {\n    constructor(logger, storageSrv) {\n        this.logger = logger;\n        this.storageSrv = storageSrv;\n        this.tableName = \"migration_log\";\n        this.logger.info(\"created Migration_logRepository\");\n    }\n    init() {\n        return Promise.resolve();\n    }\n    /* ref: https://db-migrate.readthedocs.io/en/latest/API/SQL/#migrations-api-sql */\n    migrations() {\n        return [{\n                migration_id: \"create table migration_log\", action: \"createTable\", args: [this.tableName, {\n                        id: { type: dataType.INTEGER, primaryKey: true, autoIncrement: true, notNull: true },\n                        migration_id: { type: dataType.STRING, length: 255, },\n                        action: { type: dataType.STRING, notNull: true, length: 20, },\n                        params: { type: dataType.TEXT, notNull: true, defaultValue: \"\", },\n                        success: { type: dataType.BOOLEAN, notNull: true, },\n                        error: { type: dataType.TEXT, defaultValue: \"\", },\n                        timestamp: { type: dataType.DATE_TIME, defaultValue: new String('CURRENT_TIMESTAMP'), },\n                    },\n                    (err) => {\n                        if (err) {\n                            this.logger.error(err);\n                        }\n                    }],\n            },\n        ];\n    }\n    getMigrationLog() {\n        return new Promise((resolve, reject) => {\n            this.storageSrv.db[\"all\"](\"select * from migration_log\", (err, logs) => {\n                if (err) {\n                    resolve([]);\n                }\n                else {\n                    resolve(logs);\n                }\n            });\n        });\n    }\n};\nMigration_logRepository = __decorate([\n    typedi_1.Service(),\n    __metadata(\"design:paramtypes\", [__1.LoggerSrv,\n        Storage_service_1.default])\n], Migration_logRepository);\nexports.default = Migration_logRepository;\n","module.exports = require(\"ejs\");"],"sourceRoot":""}