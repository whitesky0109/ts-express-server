{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./main.ts","webpack:///./server/controllers/index.ts","webpack:///./server/controllers/rest/RootController.ts","webpack:///./server/controllers/websocket/WsMessageController.ts","webpack:///./server/index.ts","webpack:///./server/polyfills.ts","webpack:///./server/services/index.ts","webpack:///./server/services/system/Logger.service.ts","webpack:///./server/services/system/Setting.service.ts","webpack:///./server/services/system/SocketManager.service.ts","webpack:///./server/services/system/Storage.service.ts","webpack:///./server/services/system/StorageMigration.service.ts","webpack:///./server/services/system/index.ts","webpack:///./server/services/system/repositories/Migration_log.repository.ts","webpack:///external \"cors\"","webpack:///external \"db-migrate-shared\"","webpack:///external \"db-migrate-sqlite3\"","webpack:///external \"ejs\"","webpack:///external \"events\"","webpack:///external \"express\"","webpack:///external \"figlet\"","webpack:///external \"http\"","webpack:///external \"morgan\"","webpack:///external \"path\"","webpack:///external \"reflect-metadata\"","webpack:///external \"routing-controllers\"","webpack:///external \"socket-controllers\"","webpack:///external \"socket.io\"","webpack:///external \"typedi\"","webpack:///external \"winston\""],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;;AClFa;AACb;AACA,4CAA4C;AAC5C;AACA,8CAA8C,cAAc;AAC5D,iCAAiC,mBAAO,CAAC,mCAAU;AACnD;AACA;;;;;;;;;;;;;;;;;;;;;;;;ACPa;AACb,8CAA8C,cAAc;AAC5D,mBAAO,CAAC,0EAAuB;AAC/B,mBAAO,CAAC,8FAAiC;;;;;;;;;;;;;ACH5B;AACb;AACA;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA,8CAA8C,cAAc;AAC5D,mBAAO,CAAC,0CAAkB;AAC1B,8BAA8B,mBAAO,CAAC,gDAAqB;AAC3D,mBAAmB,mBAAO,CAAC,kDAAgB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,wCAAwC;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC5Ca;AACb;AACA;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,oCAAoC;AACvE;AACA,8CAA8C,cAAc;AAC5D,6BAA6B,mBAAO,CAAC,8CAAoB;AACzD,mBAAmB,mBAAO,CAAC,kDAAgB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,KAAK;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AClDA,iDAAa;AACb;AACA;AACA,mCAAmC,MAAM,6BAA6B,EAAE,YAAY,WAAW,EAAE;AACjG,kCAAkC,MAAM,iCAAiC,EAAE,YAAY,WAAW,EAAE;AACpG,+BAA+B,iEAAiE,uBAAuB,EAAE,4BAA4B;AACrJ;AACA,KAAK;AACL;AACA;AACA,4CAA4C;AAC5C;AACA,8CAA8C,cAAc;AAC5D,mBAAO,CAAC,0CAAkB;AAC1B,mBAAO,CAAC,0CAAa;AACrB,8BAA8B,mBAAO,CAAC,gDAAqB;AAC3D,6BAA6B,mBAAO,CAAC,8CAAoB;AACzD,iBAAiB,mBAAO,CAAC,sBAAQ;AACjC,+BAA+B,mBAAO,CAAC,kBAAM;AAC7C,kCAAkC,mBAAO,CAAC,wBAAS;AACnD,oCAAoC,mBAAO,CAAC,4BAAW;AACvD,eAAe,mBAAO,CAAC,sBAAQ;AAC/B,eAAe,mBAAO,CAAC,sBAAQ;AAC/B,aAAa,mBAAO,CAAC,kBAAM;AAC3B,aAAa,mBAAO,CAAC,kBAAM;AAC3B,mBAAO,CAAC,oDAAe;AACvB,mBAAmB,mBAAO,CAAC,8CAAY;AACvC,mDAAmD,mBAAO,CAAC,wGAA4C;AACvG,iBAAiB,mBAAO,CAAC,sBAAQ;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,mBAAO,CAAC,gBAAK;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,4BAA4B,0BAA0B;AACtD;AACA,yCAAyC,oBAAoB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,sCAAsC;AACvD;AACA;AACA,wBAAwB,iBAAiB;AACzC;AACA,uDAAuD,KAAK;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yEAAyE,aAAa;AACtF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gGAAgG,UAAU;AAC1G,aAAa;AACb,SAAS;AACT;AACA;AACA;;;;;;;;;;;;;;AChHa;AACb,8CAA8C,cAAc;AAC5D;AACA,mBAAO,CAAC,0CAAkB;AAC1B;AACA;AACA;AACA;;;;;;;;;;;;;ACPa;AACb,8CAA8C,cAAc;AAC5D,mBAAO,CAAC,0CAAkB;AAC1B;AACA,iBAAiB,mBAAO,CAAC,mDAAU;AACnC;AACA;AACA;AACA;;;;;;;;;;;;;ACRa;AACb;AACA;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA,8CAA8C,cAAc;AAC5D,mBAAO,CAAC,0CAAkB;AAC1B,kBAAkB,mBAAO,CAAC,wBAAS;AACnC,iBAAiB,mBAAO,CAAC,sBAAQ;AACjC;AACA;AACA;AACA;AACA,yEAAyE,gCAAgC;AACzG;AACA,2CAA2C;AAC3C,oCAAoC,eAAe,GAAG,WAAW;AACjE,qBAAqB;AACrB;AACA;AACA,aAAa;AACb,qBAAqB,eAAe,GAAG,WAAW,IAAI,mBAAmB,GAAG,eAAe,KAAK,aAAa;AAC7G,qBAAqB,eAAe,GAAG,WAAW,GAAG,aAAa;AAClE;AACA,kDAAkD,0CAA0C;AAC5F,+CAA+C,wCAAwC;AACvF,+CAA+C,yBAAyB;AACxE;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,8BAA8B,2BAA2B;AACzD,2BAA2B,wBAAwB;AACnD,0BAA0B,uBAAuB;AACjD,0BAA0B,uBAAuB;AACjD,2BAA2B,wBAAwB;AACnD,2BAA2B,wBAAwB;AACnD,0BAA0B,uBAAuB;AACjD,2BAA2B,wBAAwB;AACnD,0BAA0B,uBAAuB;AACjD,gCAAgC,6BAA6B;AAC7D,4BAA4B,yBAAyB;AACrD,yBAAyB,wBAAwB;AACjD,4BAA4B,yBAAyB;AACrD,2BAA2B,wBAAwB;AACnD,6BAA6B,0BAA0B;AACvD,0BAA0B,uBAAuB;AACjD,6BAA6B,0BAA0B;AACvD;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC7Da;AACb;AACA;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA,8CAA8C,cAAc;AAC5D,mBAAO,CAAC,0CAAkB;AAC1B,iBAAiB,mBAAO,CAAC,sBAAQ;AACjC,WAAW,mBAAO,CAAC,4CAAG;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAAS;AACxB,gBAAgB,SAAS;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mBAAO,CAAC,6DAA0B;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACpDa;AACb;AACA;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA,8CAA8C,cAAc;AAC5D,mBAAO,CAAC,0CAAkB;AAC1B,iBAAiB,mBAAO,CAAC,sBAAQ;AACjC,WAAW,mBAAO,CAAC,4CAAG;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,KAAK;AACpB;AACA,sCAAsC,GAAG;AACzC;AACA;AACA,wCAAwC,GAAG;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACpDa;AACb;AACA;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA,eAAe,mBAAO,CAAC,8CAAoB;AAC3C,OAAO,WAAW,GAAG,mBAAO,CAAC,4CAAmB;AAChD,mBAAO,CAAC,0CAAkB;AAC1B,iBAAiB,mBAAO,CAAC,sBAAQ;AACjC,WAAW,mBAAO,CAAC,4CAAG;AACtB,iBAAiB,mBAAO,CAAC,sBAAQ;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,YAAY;AACjE;AACA,aAAa;AACb;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA,8CAA8C,OAAO;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,uCAAuC;AACvC,0CAA0C;AAC1C;AACA;AACA,4BAA4B,2CAA2C;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA,4CAA4C,QAAQ,qFAAqF,EAAE;AAC3I;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC3Ea;AACb;AACA;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA,8CAA8C,cAAc;AAC5D,mBAAO,CAAC,0CAAkB;AAC1B,iBAAiB,mBAAO,CAAC,sBAAQ;AACjC,iBAAiB,mBAAO,CAAC,sBAAQ;AACjC,mDAAmD,mBAAO,CAAC,kHAAyC;AACpG,0CAA0C,mBAAO,CAAC,sEAAmB;AACrE,WAAW,mBAAO,CAAC,4CAAG;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,8BAA8B,6BAA6B;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,6BAA6B;AACjD;AACA,4CAA4C,aAAa;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC5Fa;AACb;AACA,4CAA4C;AAC5C;AACA,8CAA8C,cAAc;AAC5D,yCAAyC,mBAAO,CAAC,oEAAkB;AACnE;AACA,0CAA0C,mBAAO,CAAC,sEAAmB;AACrE;AACA,gDAAgD,mBAAO,CAAC,kFAAyB;AACjF;AACA,0CAA0C,mBAAO,CAAC,sEAAmB;AACrE;;;;;;;;;;;;;ACZa;AACb;AACA;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA,8CAA8C,cAAc;AAC5D,mBAAO,CAAC,0CAAkB;AAC1B,iBAAiB,mBAAO,CAAC,sBAAQ;AACjC,0CAA0C,mBAAO,CAAC,uEAAoB;AACtE,YAAY,mBAAO,CAAC,6CAAI;AACxB,OAAO,WAAW,GAAG,mBAAO,CAAC,4CAAmB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,+EAA+E;AAC5G,uCAAuC,sCAAsC;AAC7E,iCAAiC,oDAAoD;AACrF,iCAAiC,wDAAwD;AACzF,kCAAkC,yCAAyC;AAC3E,gCAAgC,yCAAyC;AACzE,oCAAoC,2EAA2E;AAC/G,qBAAqB;AACrB;AACA;AACA;AACA;AACA,qBAAqB;AACrB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACnEA,iC;;;;;;;;;;;ACAA,8C;;;;;;;;;;;ACAA,+C;;;;;;;;;;;ACAA,gC;;;;;;;;;;;ACAA,mC;;;;;;;;;;;ACAA,oC;;;;;;;;;;;ACAA,mC;;;;;;;;;;;ACAA,iC;;;;;;;;;;;ACAA,mC;;;;;;;;;;;ACAA,iC;;;;;;;;;;;ACAA,6C;;;;;;;;;;;ACAA,gD;;;;;;;;;;;ACAA,+C;;;;;;;;;;;ACAA,sC;;;;;;;;;;;ACAA,mC;;;;;;;;;;;ACAA,oC","file":"server.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./main.ts\");\n","\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst server_1 = __importDefault(require(\"./server\"));\r\nconst serv = new server_1.default(process.env.PORT);\r\nserv.runServ();\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nrequire(\"./rest/RootController\");\r\nrequire(\"./websocket/WsMessageController\");\r\n","\"use strict\";\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __metadata = (this && this.__metadata) || function (k, v) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nrequire(\"reflect-metadata\");\r\nconst routing_controllers_1 = require(\"routing-controllers\");\r\nconst services_1 = require(\"../../services\");\r\nlet RootController = class RootController {\r\n    constructor(loggerSrv) {\r\n        this.loggerSrv = loggerSrv;\r\n        this.loggerSrv.info(\"created RootController\");\r\n    }\r\n    helloServer() {\r\n    }\r\n    getApi() {\r\n        return [\r\n            { hello: \"Hello Node.js Express Server\" },\r\n        ];\r\n    }\r\n};\r\n__decorate([\r\n    routing_controllers_1.Get(\"/\"),\r\n    routing_controllers_1.Render(\"index.html\"),\r\n    __metadata(\"design:type\", Function),\r\n    __metadata(\"design:paramtypes\", []),\r\n    __metadata(\"design:returntype\", void 0)\r\n], RootController.prototype, \"helloServer\", null);\r\n__decorate([\r\n    routing_controllers_1.Get(\"/api\"),\r\n    __metadata(\"design:type\", Function),\r\n    __metadata(\"design:paramtypes\", []),\r\n    __metadata(\"design:returntype\", void 0)\r\n], RootController.prototype, \"getApi\", null);\r\nRootController = __decorate([\r\n    routing_controllers_1.Controller(\"\"),\r\n    __metadata(\"design:paramtypes\", [services_1.LoggerSrv])\r\n], RootController);\r\nexports.RootController = RootController;\r\n","\"use strict\";\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __metadata = (this && this.__metadata) || function (k, v) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst socket_controllers_1 = require(\"socket-controllers\");\r\nconst services_1 = require(\"../../services\");\r\nlet WsMessageController = class WsMessageController {\r\n    constructor(sockMgrSrv, loggerSrv) {\r\n        this.sockMgrSrv = sockMgrSrv;\r\n        this.loggerSrv = loggerSrv;\r\n        this.loggerSrv.info(\"created WsMessageController\");\r\n    }\r\n    connection(socket) {\r\n        this.sockMgrSrv.addSocket(socket);\r\n        this.loggerSrv.info(\"client connected\");\r\n    }\r\n    disconnect(socket) {\r\n        const { id } = socket;\r\n        this.sockMgrSrv.delSocket(id);\r\n    }\r\n};\r\n__decorate([\r\n    socket_controllers_1.OnConnect(),\r\n    __param(0, socket_controllers_1.ConnectedSocket()),\r\n    __metadata(\"design:type\", Function),\r\n    __metadata(\"design:paramtypes\", [Object]),\r\n    __metadata(\"design:returntype\", void 0)\r\n], WsMessageController.prototype, \"connection\", null);\r\n__decorate([\r\n    socket_controllers_1.OnDisconnect(),\r\n    __param(0, socket_controllers_1.ConnectedSocket()),\r\n    __metadata(\"design:type\", Function),\r\n    __metadata(\"design:paramtypes\", [Object]),\r\n    __metadata(\"design:returntype\", void 0)\r\n], WsMessageController.prototype, \"disconnect\", null);\r\nWsMessageController = __decorate([\r\n    socket_controllers_1.SocketController(\"/ws\"),\r\n    __metadata(\"design:paramtypes\", [services_1.SocketManagerSrv,\r\n        services_1.LoggerSrv])\r\n], WsMessageController);\r\nexports.WsMessageController = WsMessageController;\r\n","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nrequire(\"reflect-metadata\");\r\nrequire(\"./polyfills\");\r\nconst routing_controllers_1 = require(\"routing-controllers\");\r\nconst socket_controllers_1 = require(\"socket-controllers\");\r\nconst typedi_1 = require(\"typedi\");\r\nconst http_1 = __importDefault(require(\"http\"));\r\nconst express_1 = __importDefault(require(\"express\"));\r\nconst socket_io_1 = __importDefault(require(\"socket.io\"));\r\nconst morgan = require('morgan');\r\nconst figlet = require('figlet');\r\nconst cors = require(\"cors\");\r\nconst path = require('path');\r\nrequire(\"./controllers\");\r\nconst services_1 = require(\"./services\");\r\nconst StorageMigration_service_1 = __importDefault(require(\"./services/system/StorageMigration.service\"));\r\nconst events_1 = require(\"events\");\r\nclass MainServer extends events_1.EventEmitter {\r\n    constructor(port) {\r\n        const rootPath = path.join(\"dist\", 'public');\r\n        super();\r\n        /* setter */\r\n        routing_controllers_1.useContainer(typedi_1.Container);\r\n        socket_controllers_1.useContainer(typedi_1.Container);\r\n        /* create Server */\r\n        this.app = express_1.default();\r\n        this.app.use(cors());\r\n        /* set Html View Render */\r\n        this.app.engine('html', require('ejs').renderFile);\r\n        this.app.set('views', path.join(rootPath));\r\n        this.app.set('view engine', 'html');\r\n        routing_controllers_1.useExpressServer(this.app);\r\n        this.server = http_1.default.createServer(this.app);\r\n        this.app.use(\"/public\", express_1.default.static(rootPath));\r\n        /* create websocket listener */\r\n        this.io = socket_io_1.default(this.server);\r\n        this.io.use((socket, next) => {\r\n            console.log(\"Custom middleware\");\r\n            next();\r\n        });\r\n        console.log(__dirname);\r\n        socket_controllers_1.useSocketServer(this.io, {\r\n            controllers: [path.join(__dirname, \"controllers\", \"websocket\", \"*.js\")],\r\n        });\r\n        /* create System Logger */\r\n        const loggerSrv = typedi_1.Container.get(services_1.LoggerSrv);\r\n        loggerSrv.info(`\\n${figlet.textSync(\"Sample\")}`);\r\n        /* register logger Service */\r\n        this.app.use(morgan('combined', { stream: loggerSrv }));\r\n        /* register service instance */\r\n        this.addServices();\r\n        this.port = port ? parseInt(port) : typedi_1.Container.get(services_1.SettingSrv).getPort();\r\n    }\r\n    addMiddleware(middleware) {\r\n        this.app.use(middleware);\r\n    }\r\n    addServices() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const etcInstances = [\r\n                { name: \"socketIO\", instance: this.io },\r\n            ];\r\n            const loggerSrv = typedi_1.Container.get(services_1.LoggerSrv);\r\n            for (const { name, instance } of etcInstances) {\r\n                typedi_1.Container.set(name, instance);\r\n                loggerSrv.info(`[init] DI Registered ${name}`);\r\n            }\r\n            const registerServices = [\r\n                /* System Services */\r\n                services_1.SettingSrv,\r\n                services_1.StorageSrv,\r\n                StorageMigration_service_1.default,\r\n                services_1.SocketManagerSrv,\r\n            ];\r\n            // register system services\r\n            for (const service of registerServices) {\r\n                try {\r\n                    const instance = typedi_1.Container.get(service);\r\n                    yield instance.init();\r\n                    loggerSrv.info(`[Serivce Initialize] DI Registered ${service.name}`);\r\n                }\r\n                catch (e) {\r\n                    console.log(e.stack);\r\n                    loggerSrv.error(e);\r\n                }\r\n            }\r\n            this.emit(\"ready\");\r\n        });\r\n    }\r\n    getApp() {\r\n        return this.app;\r\n    }\r\n    runServ() {\r\n        const loggerSrv = typedi_1.Container.get(services_1.LoggerSrv);\r\n        return new Promise((resolve) => {\r\n            this.once(\"ready\", () => {\r\n                resolve(this.server.listen(this.port, () => loggerSrv.info(`listening on port ${this.port}`)));\r\n            });\r\n        });\r\n    }\r\n}\r\nexports.default = MainServer;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/** reflect-metadata **/\r\nrequire(\"reflect-metadata\");\r\n// /** fetch **/\r\n// import 'isomorphic-fetch';\r\n/** Symbol.asyncIterator **/\r\n// import 'core-js/es7/symbol'\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nrequire(\"reflect-metadata\");\r\n// System Services\r\nconst system_1 = require(\"./system\");\r\nexports.SettingSrv = system_1.SettingSrv;\r\nexports.StorageSrv = system_1.StorageSrv;\r\nexports.LoggerSrv = system_1.LoggerSrv;\r\nexports.SocketManagerSrv = system_1.SocketManagerSrv;\r\n","\"use strict\";\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __metadata = (this && this.__metadata) || function (k, v) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nrequire(\"reflect-metadata\");\r\nconst winston_1 = require(\"winston\");\r\nconst typedi_1 = require(\"typedi\");\r\nlet LoggerSrv = class LoggerSrv {\r\n    constructor() {\r\n        this.logger = winston_1.createLogger({\r\n            // level: 'info',\r\n            format: winston_1.format.combine(winston_1.format.timestamp({ format: `YYYY-MM-DD HH:mm:ss` }), winston_1.format(info => {\r\n                if (info.level === \"error\") {\r\n                    return Object.assign({}, info, {\r\n                        message: `${info.timestamp} ${info.stack}`,\r\n                    });\r\n                }\r\n                return info;\r\n            })(), winston_1.format.printf(info => (info.meta)\r\n                ? `${info.timestamp} ${info.level} [${info.meta.filename}:${info.meta.line}]: ${info.message}`\r\n                : `${info.timestamp} ${info.level} ${info.message}`)),\r\n            transports: [\r\n                new winston_1.transports.Console({ level: 'debug', handleExceptions: true, }),\r\n                new winston_1.transports.File({ filename: 'error.log', level: 'error' }),\r\n                new winston_1.transports.File({ filename: 'system.log' })\r\n            ],\r\n            exitOnError: false\r\n        });\r\n    }\r\n    init() {\r\n        this.logger.info(\"created LoggerSrv\");\r\n    }\r\n    write(message, encoding) { this.logger.info(message); }\r\n    alert(msg, index = 3) { this.logger.alert(msg); }\r\n    crit(msg, index = 3) { this.logger.crit(msg); }\r\n    data(msg, index = 3) { this.logger.data(msg); }\r\n    debug(msg, index = 3) { this.logger.debug(msg); }\r\n    error(msg, index = 3) { this.logger.error(msg); }\r\n    help(msg, index = 3) { this.logger.help(msg); }\r\n    input(msg, index = 3) { this.logger.input(msg); }\r\n    info(msg, index = 3) { this.logger.info(msg); }\r\n    log(level, msg, index = 3) { this.logger.log(level, msg); }\r\n    notice(msg, index = 3) { this.logger.notice(msg); }\r\n    sql(msg, index = 3) { this.debug(msg, index); }\r\n    prompt(msg, index = 3) { this.logger.prompt(msg); }\r\n    silly(msg, index = 3) { this.logger.silly(msg); }\r\n    verbose(msg, index = 3) { this.logger.verbose(msg); }\r\n    warn(msg, index = 3) { this.logger.warn(msg); }\r\n    warning(msg, index = 3) { this.logger.warning(msg); }\r\n};\r\nLoggerSrv = __decorate([\r\n    typedi_1.Service(),\r\n    __metadata(\"design:paramtypes\", [])\r\n], LoggerSrv);\r\nexports.default = LoggerSrv;\r\n","\"use strict\";\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __metadata = (this && this.__metadata) || function (k, v) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nrequire(\"reflect-metadata\");\r\nconst typedi_1 = require(\"typedi\");\r\nconst _1 = require(\".\");\r\nlet SettingSrv = class SettingSrv {\r\n    constructor(logger) {\r\n        this.logger = logger;\r\n        this.logger.info(\"created SettingSrv\");\r\n        this.settings = this.loadSettingFile();\r\n    }\r\n    init() {\r\n        return Promise.resolve();\r\n    }\r\n    /**\r\n     * Create a `uid`\r\n     *\r\n     * @param { Number } len\r\n     * @return { String } uid\r\n     */\r\n    uid(len) {\r\n        // create uuid\r\n        len = len || 7;\r\n        return Math.random().toString(35).substr(2, len);\r\n    }\r\n    loadSettingFile() {\r\n        const config = require(\"../../config/config.json\");\r\n        return config;\r\n    }\r\n    getPort() {\r\n        return this.settings[\"port\"];\r\n    }\r\n    getSystemDbName() {\r\n        return this.settings.sqlite;\r\n    }\r\n    getSettings() {\r\n        return this.settings;\r\n    }\r\n};\r\nSettingSrv = __decorate([\r\n    typedi_1.Service(),\r\n    __metadata(\"design:paramtypes\", [_1.LoggerSrv])\r\n], SettingSrv);\r\nexports.default = SettingSrv;\r\n","\"use strict\";\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __metadata = (this && this.__metadata) || function (k, v) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nrequire(\"reflect-metadata\");\r\nconst typedi_1 = require(\"typedi\");\r\nconst _1 = require(\".\");\r\nlet SocketManagerSrv = class SocketManagerSrv {\r\n    constructor(logger) {\r\n        this.logger = logger;\r\n        this.sockets = {};\r\n        this.logger.info(\"created SocketMangerSrv\");\r\n    }\r\n    init() {\r\n        return Promise.resolve();\r\n    }\r\n    addSocket(socket) {\r\n        const { id } = socket;\r\n        this.sockets[id] = socket;\r\n        this.logger.info(`registerd ${id}`);\r\n    }\r\n    delSocket(id) {\r\n        this.logger.info(`unregisterd ${id}`);\r\n        delete this.sockets[id];\r\n    }\r\n    getSocket(id) {\r\n        return this.sockets[id];\r\n    }\r\n    isExistSocket(id) {\r\n        return !!this.sockets[id];\r\n    }\r\n    getAll() {\r\n        return this.sockets;\r\n    }\r\n    emitAll(event, message) {\r\n        for (const id in this.sockets) {\r\n            const socket = this.sockets[id];\r\n            socket.emit(event, message);\r\n        }\r\n    }\r\n};\r\nSocketManagerSrv = __decorate([\r\n    typedi_1.Service(),\r\n    __metadata(\"design:paramtypes\", [_1.LoggerSrv])\r\n], SocketManagerSrv);\r\nexports.default = SocketManagerSrv;\r\n","\"use strict\";\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __metadata = (this && this.__metadata) || function (k, v) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/*\r\n    sqlite3 node libraries\r\n    ref: https://db-migrate.readthedocs.io/en/latest/API/SQL/#migrations-api-sql\r\n*/\r\nconst driver = require(\"db-migrate-sqlite3\");\r\nconst { dataType } = require('db-migrate-shared');\r\nrequire(\"reflect-metadata\");\r\nconst typedi_1 = require(\"typedi\");\r\nconst _1 = require(\".\");\r\nconst events_1 = require(\"events\");\r\nlet StorageSrv = class StorageSrv extends events_1.EventEmitter {\r\n    constructor(logger, settingSrv) {\r\n        super();\r\n        this.logger = logger;\r\n        this.settingSrv = settingSrv;\r\n        this.logger.info(\"created StorageSrv\");\r\n        this.dbname = this.settingSrv.getSystemDbName();\r\n    }\r\n    init() {\r\n        return new Promise((resolve, reject) => {\r\n            this.connect(this.dbname).then((db) => {\r\n                this.db = db;\r\n                this.logger.info(`Connected to the ${this.dbname} database.`);\r\n                resolve();\r\n            }, (error) => {\r\n                reject(error);\r\n            });\r\n        });\r\n    }\r\n    connect(dbname) {\r\n        this.logger.info(`try load sqlite : ${dbname}`);\r\n        this.logger['sql'] = this.sqlLogger.bind(this);\r\n        return new Promise((resolve, reject) => {\r\n            /* if not exist then create database file */\r\n            const internals = {\r\n                mod: {\r\n                    log: this.logger,\r\n                    type: dataType,\r\n                },\r\n                interfaces: {\r\n                    SeederInterface: {},\r\n                    MigratorInterfrace: {},\r\n                }\r\n            };\r\n            driver.connect({ driver: \"sqlite3\", filename: this.dbname }, internals, (err, db) => {\r\n                if (err) {\r\n                    reject(err);\r\n                }\r\n                else {\r\n                    db.all(\"PRAGMA foreign_keys=ON\");\r\n                    resolve(db);\r\n                }\r\n            });\r\n        });\r\n    }\r\n    sqlLogger() {\r\n        // this.logger.debug(arguments[0], { meta: { __filename, __function: (global as any).__function, __line: (global as any).__line } } );\r\n    }\r\n};\r\nStorageSrv = __decorate([\r\n    typedi_1.Service(),\r\n    __metadata(\"design:paramtypes\", [_1.LoggerSrv,\r\n        _1.SettingSrv])\r\n], StorageSrv);\r\nexports.default = StorageSrv;\r\n","\"use strict\";\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __metadata = (this && this.__metadata) || function (k, v) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nrequire(\"reflect-metadata\");\r\nconst typedi_1 = require(\"typedi\");\r\nconst events_1 = require(\"events\");\r\nconst Migration_log_repository_1 = __importDefault(require(\"./repositories/Migration_log.repository\"));\r\nconst Storage_service_1 = __importDefault(require(\"./Storage.service\"));\r\nconst _1 = require(\".\");\r\nlet StorageMigrationSrv = class StorageMigrationSrv extends events_1.EventEmitter {\r\n    constructor(logger, storageSrv, \r\n    /* sqlite3 table reposiotries */\r\n    migrationLogRepository) {\r\n        super();\r\n        this.logger = logger;\r\n        this.storageSrv = storageSrv;\r\n        this.migrationLogRepository = migrationLogRepository;\r\n        this.migrations = [];\r\n        this.logger.info(\"created StorageMigrationSrv\");\r\n    }\r\n    init() {\r\n        let migrationLogs = {};\r\n        return this.migrationLogRepository.getMigrationLog().then((logs) => {\r\n            for (const log of logs) {\r\n                if (log.success) {\r\n                    migrationLogs[log.migration_id] = log;\r\n                }\r\n            }\r\n            return migrationLogs;\r\n        }).then((migrationLogs) => {\r\n            this.addMigrations();\r\n            this.dbMigration(migrationLogs);\r\n        });\r\n    }\r\n    addMigration(migration_id, action, args) {\r\n        this.migrations.push({ migration_id, action, args });\r\n    }\r\n    addMigrations() {\r\n        const arr = [\r\n            this.migrationLogRepository.migrations(),\r\n        ];\r\n        for (const migration of arr) {\r\n            this.migrations = this.migrations.concat(migration);\r\n        }\r\n    }\r\n    dbMigration(migrationLogs) {\r\n        for (const { migration_id, action, args } of this.migrations) {\r\n            if (!migrationLogs[migration_id]) {\r\n                this.logger.info(`execute ${migration_id}`);\r\n                /* change callback function */\r\n                const callback = args[args.length - 1];\r\n                args[args.length - 1] = (...params) => {\r\n                    const [err] = params;\r\n                    const success = !err ? true : false;\r\n                    /* double quatation이 들어간 경우 오류 발생 */\r\n                    const error = err ? err.message.replace(/\\\"/gi, \"'\") : \"\";\r\n                    const arg = JSON.stringify(args.slice(0, args.length - 1)).replace(/\\\"/gi, \"'\");\r\n                    /* write migration_log */\r\n                    this.storageSrv.db[\"insert\"](\"migration_log\", [\"migration_id\", \"action\", \"success\", \"error\", \"params\",], [migration_id, action, success, error, arg], (err) => {\r\n                        if (err) {\r\n                            this.logger.error(err);\r\n                        }\r\n                    });\r\n                    callback.apply(this.storageSrv.db, params);\r\n                };\r\n                try {\r\n                    this.storageSrv.db[action].apply(this.storageSrv.db, args);\r\n                }\r\n                catch (err) {\r\n                    this.logger.error(err);\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\nStorageMigrationSrv = __decorate([\r\n    typedi_1.Service(),\r\n    __metadata(\"design:paramtypes\", [_1.LoggerSrv,\r\n        Storage_service_1.default,\r\n        Migration_log_repository_1.default])\r\n], StorageMigrationSrv);\r\nexports.default = StorageMigrationSrv;\r\n","\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst Logger_service_1 = __importDefault(require(\"./Logger.service\"));\r\nexports.LoggerSrv = Logger_service_1.default;\r\nconst Setting_service_1 = __importDefault(require(\"./Setting.service\"));\r\nexports.SettingSrv = Setting_service_1.default;\r\nconst SocketManager_service_1 = __importDefault(require(\"./SocketManager.service\"));\r\nexports.SocketManagerSrv = SocketManager_service_1.default;\r\nconst Storage_service_1 = __importDefault(require(\"./Storage.service\"));\r\nexports.StorageSrv = Storage_service_1.default;\r\n","\"use strict\";\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __metadata = (this && this.__metadata) || function (k, v) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nrequire(\"reflect-metadata\");\r\nconst typedi_1 = require(\"typedi\");\r\nconst Storage_service_1 = __importDefault(require(\"../Storage.service\"));\r\nconst __1 = require(\"..\");\r\nconst { dataType } = require('db-migrate-shared');\r\nlet Migration_logRepository = class Migration_logRepository {\r\n    constructor(logger, storageSrv) {\r\n        this.logger = logger;\r\n        this.storageSrv = storageSrv;\r\n        this.tableName = \"migration_log\";\r\n        this.logger.info(\"created Migration_logRepository\");\r\n    }\r\n    init() {\r\n        return Promise.resolve();\r\n    }\r\n    /* ref: https://db-migrate.readthedocs.io/en/latest/API/SQL/#migrations-api-sql */\r\n    migrations() {\r\n        return [{\r\n                migration_id: \"create table migration_log\", action: \"createTable\", args: [this.tableName, {\r\n                        id: { type: dataType.INTEGER, primaryKey: true, autoIncrement: true, notNull: true },\r\n                        migration_id: { type: dataType.STRING, length: 255, },\r\n                        action: { type: dataType.STRING, notNull: true, length: 20, },\r\n                        params: { type: dataType.TEXT, notNull: true, defaultValue: \"\", },\r\n                        success: { type: dataType.BOOLEAN, notNull: true, },\r\n                        error: { type: dataType.TEXT, defaultValue: \"\", },\r\n                        timestamp: { type: dataType.DATE_TIME, defaultValue: new String('CURRENT_TIMESTAMP'), },\r\n                    },\r\n                    (err) => {\r\n                        if (err) {\r\n                            this.logger.error(err);\r\n                        }\r\n                    }],\r\n            },\r\n        ];\r\n    }\r\n    getMigrationLog() {\r\n        return new Promise((resolve, reject) => {\r\n            this.storageSrv.db[\"all\"](\"select * from migration_log\", (err, logs) => {\r\n                if (err) {\r\n                    resolve([]);\r\n                }\r\n                else {\r\n                    resolve(logs);\r\n                }\r\n            });\r\n        });\r\n    }\r\n};\r\nMigration_logRepository = __decorate([\r\n    typedi_1.Service(),\r\n    __metadata(\"design:paramtypes\", [__1.LoggerSrv,\r\n        Storage_service_1.default])\r\n], Migration_logRepository);\r\nexports.default = Migration_logRepository;\r\n","module.exports = require(\"cors\");","module.exports = require(\"db-migrate-shared\");","module.exports = require(\"db-migrate-sqlite3\");","module.exports = require(\"ejs\");","module.exports = require(\"events\");","module.exports = require(\"express\");","module.exports = require(\"figlet\");","module.exports = require(\"http\");","module.exports = require(\"morgan\");","module.exports = require(\"path\");","module.exports = require(\"reflect-metadata\");","module.exports = require(\"routing-controllers\");","module.exports = require(\"socket-controllers\");","module.exports = require(\"socket.io\");","module.exports = require(\"typedi\");","module.exports = require(\"winston\");"],"sourceRoot":""}